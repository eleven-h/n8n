# n8n æ‰§è¡Œæ—¥å¿—åˆ†ææŒ‡å—

## ğŸ” ä»€ä¹ˆæ˜¯æ‰§è¡Œæ—¥å¿—ï¼Ÿ

æ‰§è¡Œæ—¥å¿—æ˜¯ n8n å·¥ä½œæµè¿è¡Œè¿‡ç¨‹ä¸­äº§ç”Ÿçš„è¯¦ç»†è®°å½•ï¼ŒåŒ…å«äº†æ¯ä¸ªèŠ‚ç‚¹çš„æ‰§è¡ŒçŠ¶æ€ã€æ•°æ®æµè½¬ã€é”™è¯¯ä¿¡æ¯ç­‰å…³é”®ä¿¡æ¯ï¼Œæ˜¯**è°ƒè¯•å’Œæ’é”™çš„é‡è¦å·¥å…·**ã€‚

## ğŸ“Š æ—¥å¿—ç±»å‹å’Œä½ç½®

### 1. å·¥ä½œæµæ‰§è¡Œæ—¥å¿—
- **ä½ç½®**ï¼šn8n ç•Œé¢ â†’ å·¥ä½œæµ â†’ æ‰§è¡Œå†å²
- **å†…å®¹**ï¼šå·¥ä½œæµæ•´ä½“æ‰§è¡ŒçŠ¶æ€ã€èŠ‚ç‚¹æ‰§è¡Œé¡ºåºã€æ•°æ®ä¼ é€’
- **ç”¨é€”**ï¼šäº†è§£å·¥ä½œæµæ‰§è¡Œæµç¨‹å’Œæ€§èƒ½

### 2. èŠ‚ç‚¹æ‰§è¡Œæ—¥å¿—
- **ä½ç½®**ï¼šèŠ‚ç‚¹è¯¦æƒ… â†’ æ‰§è¡Œä¿¡æ¯
- **å†…å®¹**ï¼šå•ä¸ªèŠ‚ç‚¹çš„è¾“å…¥è¾“å‡ºã€æ‰§è¡Œæ—¶é—´ã€é”™è¯¯è¯¦æƒ…
- **ç”¨é€”**ï¼šå®šä½å…·ä½“èŠ‚ç‚¹çš„æ‰§è¡Œé—®é¢˜

### 3. ç³»ç»Ÿæ—¥å¿—
- **ä½ç½®**ï¼šæœåŠ¡å™¨æ—¥å¿—æ–‡ä»¶ã€Docker å®¹å™¨æ—¥å¿—
- **å†…å®¹**ï¼šç³»ç»Ÿçº§é”™è¯¯ã€ç½‘ç»œé—®é¢˜ã€èµ„æºä½¿ç”¨æƒ…å†µ
- **ç”¨é€”**ï¼šæ’æŸ¥ç³»ç»Ÿçº§é—®é¢˜

## ğŸš€ å¦‚ä½•æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—

### æ–¹æ³• 1ï¼šn8n ç•Œé¢æŸ¥çœ‹
1. **æ‰“å¼€å·¥ä½œæµ**ï¼šé€‰æ‹©è¦åˆ†æçš„å·¥ä½œæµ
2. **æŸ¥çœ‹æ‰§è¡Œå†å²**ï¼šç‚¹å‡»"æ‰§è¡Œå†å²"æ ‡ç­¾
3. **é€‰æ‹©æ‰§è¡Œè®°å½•**ï¼šç‚¹å‡»å…·ä½“çš„æ‰§è¡Œè®°å½•
4. **åˆ†ææ‰§è¡Œè¯¦æƒ…**ï¼šæŸ¥çœ‹æ¯ä¸ªèŠ‚ç‚¹çš„æ‰§è¡ŒçŠ¶æ€

### æ–¹æ³• 2ï¼šå‘½ä»¤è¡ŒæŸ¥çœ‹
```bash
# æŸ¥çœ‹ n8n è¿›ç¨‹æ—¥å¿—
tail -f ~/.n8n/logs/n8n.log

# æŸ¥çœ‹ Docker å®¹å™¨æ—¥å¿—
docker logs -f n8n

# æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
journalctl -u n8n -f
```

### æ–¹æ³• 3ï¼šAPI æ¥å£æŸ¥çœ‹
```bash
# è·å–å·¥ä½œæµæ‰§è¡Œå†å²
curl -X GET "http://localhost:5678/api/v1/workflows/{id}/executions" \
  -H "Authorization: Bearer your-token"
```

## ğŸ“‹ æ—¥å¿—å†…å®¹è§£æ

### 1. å·¥ä½œæµæ‰§è¡Œä¿¡æ¯
```json
{
  "id": "execution-id",
  "workflowId": "workflow-id",
  "status": "success",
  "startedAt": "2024-01-15T10:00:00Z",
  "finishedAt": "2024-01-15T10:00:30Z",
  "duration": 30000,
  "nodes": [
    {
      "node": "Webhook",
      "status": "success",
      "startTime": "2024-01-15T10:00:01Z",
      "endTime": "2024-01-15T10:00:02Z"
    }
  ]
}
```

### 2. èŠ‚ç‚¹æ‰§è¡Œè¯¦æƒ…
```json
{
  "node": "HTTP Request",
  "status": "success",
  "startTime": "2024-01-15T10:00:02Z",
  "endTime": "2024-01-15T10:00:05Z",
  "duration": 3000,
  "input": [
    {
      "json": {
        "url": "https://api.example.com/data",
        "method": "GET"
      }
    }
  ],
  "output": [
    {
      "json": {
        "status": "success",
        "data": [...]
      }
    }
  ]
}
```

### 3. é”™è¯¯ä¿¡æ¯ç»“æ„
```json
{
  "error": {
    "message": "Request failed with status code 404",
    "name": "HTTPError",
    "stack": "Error: Request failed...",
    "cause": {
      "code": "ENOTFOUND",
      "message": "getaddrinfo ENOTFOUND api.example.com"
    }
  }
}
```

## ğŸ” å¸¸è§æ—¥å¿—åˆ†æåœºæ™¯

### åœºæ™¯ 1ï¼šå·¥ä½œæµæ‰§è¡Œå¤±è´¥

#### æ—¥å¿—ç‰¹å¾
```
ERROR: Workflow execution failed
Node "HTTP Request" failed with error: Request timeout
```

#### åˆ†ææ­¥éª¤
1. **æŸ¥çœ‹é”™è¯¯èŠ‚ç‚¹**ï¼šç¡®å®šå“ªä¸ªèŠ‚ç‚¹å¤±è´¥
2. **æ£€æŸ¥é”™è¯¯ç±»å‹**ï¼šç½‘ç»œé”™è¯¯ã€è®¤è¯é”™è¯¯ã€æ•°æ®é”™è¯¯ç­‰
3. **åˆ†æé”™è¯¯åŸå› **ï¼šè¶…æ—¶ã€æƒé™ä¸è¶³ã€æ•°æ®æ ¼å¼é”™è¯¯ç­‰
4. **æŸ¥çœ‹è¾“å…¥æ•°æ®**ï¼šæ£€æŸ¥ä¼ é€’ç»™å¤±è´¥èŠ‚ç‚¹çš„æ•°æ®

#### è§£å†³æ–¹æ¡ˆ
```javascript
// åœ¨ Code èŠ‚ç‚¹ä¸­æ·»åŠ é”™è¯¯å¤„ç†
try {
  const result = await makeHttpRequest($input.first().json);
  return result;
} catch (error) {
  console.error('HTTP request failed:', error);
  
  // è¿”å›é»˜è®¤å€¼æˆ–é‡è¯•
  return {
    error: error.message,
    fallback: true
  };
}
```

### åœºæ™¯ 2ï¼šæ•°æ®æ ¼å¼ä¸åŒ¹é…

#### æ—¥å¿—ç‰¹å¾
```
ERROR: Cannot read property 'title' of undefined
TypeError: $json.title is not a string
```

#### åˆ†ææ­¥éª¤
1. **æ£€æŸ¥æ•°æ®ç»“æ„**ï¼šæŸ¥çœ‹èŠ‚ç‚¹çš„è¾“å…¥æ•°æ®æ ¼å¼
2. **éªŒè¯å­—æ®µå­˜åœ¨æ€§**ï¼šç¡®è®¤æ‰€éœ€å­—æ®µæ˜¯å¦å­˜åœ¨
3. **æ£€æŸ¥æ•°æ®ç±»å‹**ï¼šéªŒè¯å­—æ®µç±»å‹æ˜¯å¦ç¬¦åˆé¢„æœŸ
4. **æŸ¥çœ‹ä¸Šæ¸¸èŠ‚ç‚¹**ï¼šæ£€æŸ¥æ•°æ®æ¥æºèŠ‚ç‚¹çš„è¾“å‡º

#### è§£å†³æ–¹æ¡ˆ
```javascript
// æ·»åŠ æ•°æ®éªŒè¯
const input = $input.first().json;

if (!input || typeof input !== 'object') {
  throw new Error('Input data is invalid');
}

if (!input.title || typeof input.title !== 'string') {
  throw new Error('Title field is missing or invalid');
}

// å®‰å…¨åœ°è®¿é—®æ•°æ®
const title = input.title || 'Untitled';
const content = input.content || '';
```

### åœºæ™¯ 3ï¼šAPI è°ƒç”¨å¤±è´¥

#### æ—¥å¿—ç‰¹å¾
```
ERROR: API rate limit exceeded
ERROR: Authentication failed
ERROR: Network timeout
```

#### åˆ†ææ­¥éª¤
1. **æ£€æŸ¥ API çŠ¶æ€**ï¼šç¡®è®¤ç¬¬ä¸‰æ–¹æœåŠ¡æ˜¯å¦æ­£å¸¸
2. **éªŒè¯è®¤è¯ä¿¡æ¯**ï¼šæ£€æŸ¥ API å¯†é’¥å’Œæƒé™
3. **æŸ¥çœ‹è°ƒç”¨é¢‘ç‡**ï¼šç¡®è®¤æ˜¯å¦è¶…è¿‡ API é™åˆ¶
4. **æ£€æŸ¥ç½‘ç»œè¿æ¥**ï¼šéªŒè¯ç½‘ç»œè¿é€šæ€§

#### è§£å†³æ–¹æ¡ˆ
```javascript
// æ·»åŠ é‡è¯•æœºåˆ¶
const maxRetries = 3;
let retryCount = 0;

async function makeApiCall() {
  try {
    return await callApi();
  } catch (error) {
    if (retryCount < maxRetries && isRetryableError(error)) {
      retryCount++;
      await delay(1000 * retryCount); // æŒ‡æ•°é€€é¿
      return makeApiCall();
    }
    throw error;
  }
}

function isRetryableError(error) {
  return error.code === 'RATE_LIMIT' || 
         error.code === 'TIMEOUT' ||
         error.code === 'NETWORK_ERROR';
}
```

### åœºæ™¯ 4ï¼šæ€§èƒ½é—®é¢˜

#### æ—¥å¿—ç‰¹å¾
```
WARN: Node execution took 15 seconds
WARN: Memory usage high: 85%
```

#### åˆ†ææ­¥éª¤
1. **è¯†åˆ«æ…¢èŠ‚ç‚¹**ï¼šæŸ¥çœ‹å„èŠ‚ç‚¹çš„æ‰§è¡Œæ—¶é—´
2. **åˆ†ææ•°æ®é‡**ï¼šæ£€æŸ¥å¤„ç†çš„æ•°æ®é‡å¤§å°
3. **æ£€æŸ¥èµ„æºä½¿ç”¨**ï¼šç›‘æ§ CPUã€å†…å­˜ã€ç½‘ç»œä½¿ç”¨
4. **æŸ¥çœ‹å¹¶å‘è®¾ç½®**ï¼šç¡®è®¤å¹¶å‘é…ç½®æ˜¯å¦åˆç†

#### è§£å†³æ–¹æ¡ˆ
```javascript
// åˆ†æ‰¹å¤„ç†å¤§æ•°æ®
const batchSize = 100;
const items = $input.all();
const batches = [];

for (let i = 0; i < items.length; i += batchSize) {
  batches.push(items.slice(i, i + batchSize));
}

// å¹¶è¡Œå¤„ç†æ‰¹æ¬¡
const results = await Promise.all(
  batches.map(batch => processBatch(batch))
);

return results.flat();
```

## ğŸ› ï¸ æ—¥å¿—åˆ†æå·¥å…·å’ŒæŠ€å·§

### 1. ä½¿ç”¨ Code èŠ‚ç‚¹è®°å½•æ—¥å¿—
```javascript
// è®°å½•å…³é”®ä¿¡æ¯
console.log('Processing item:', {
  id: $json.id,
  type: $json.type,
  timestamp: new Date().toISOString()
});

// è®°å½•æ•°æ®ç»Ÿè®¡
const items = $input.all();
console.log(`Processing ${items.length} items`);

// è®°å½•æ€§èƒ½æŒ‡æ ‡
const startTime = Date.now();
// ... å¤„ç†é€»è¾‘ ...
const duration = Date.now() - startTime;
console.log(`Processing completed in ${duration}ms`);
```

### 2. ç»“æ„åŒ–æ—¥å¿—è®°å½•
```javascript
// åˆ›å»ºç»“æ„åŒ–æ—¥å¿—
const logEntry = {
  level: 'info',
  timestamp: new Date().toISOString(),
  node: 'Data Processing',
  action: 'transform_data',
  input: {
    count: $input.all().length,
    sample: $input.first().json
  },
  metadata: {
    workflowId: $workflow.id,
    executionId: $execution.id
  }
};

console.log(JSON.stringify(logEntry));
```

### 3. æ¡ä»¶æ—¥å¿—è®°å½•
```javascript
// æ ¹æ®æ¡ä»¶è®°å½•ä¸åŒçº§åˆ«çš„æ—¥å¿—
const logLevel = process.env.LOG_LEVEL || 'info';

function log(level, message, data) {
  const levels = { error: 0, warn: 1, info: 2, debug: 3 };
  
  if (levels[level] <= levels[logLevel]) {
    console.log(`[${level.toUpperCase()}] ${message}`, data);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
log('info', 'Processing started', { count: $input.all().length });
log('debug', 'Raw data', $input.first().json);
```

## ğŸ“Š æ—¥å¿—ç›‘æ§å’Œå‘Šè­¦

### 1. å…³é”®æŒ‡æ ‡ç›‘æ§
```javascript
// ç›‘æ§å·¥ä½œæµæ‰§è¡ŒçŠ¶æ€
const executionStats = {
  totalExecutions: 0,
  successfulExecutions: 0,
  failedExecutions: 0,
  averageDuration: 0
};

// è®°å½•æ‰§è¡Œç»Ÿè®¡
function recordExecution(status, duration) {
  executionStats.totalExecutions++;
  if (status === 'success') {
    executionStats.successfulExecutions++;
  } else {
    executionStats.failedExecutions++;
  }
  
  // æ›´æ–°å¹³å‡æ‰§è¡Œæ—¶é—´
  const total = executionStats.averageDuration * (executionStats.totalExecutions - 1);
  executionStats.averageDuration = (total + duration) / executionStats.totalExecutions;
  
  console.log('Execution stats:', executionStats);
}
```

### 2. é”™è¯¯ç‡ç›‘æ§
```javascript
// è®¡ç®—é”™è¯¯ç‡
const errorRate = executionStats.failedExecutions / executionStats.totalExecutions;

// è®¾ç½®å‘Šè­¦é˜ˆå€¼
if (errorRate > 0.1) { // é”™è¯¯ç‡è¶…è¿‡ 10%
  console.warn('High error rate detected:', errorRate);
  
  // å‘é€å‘Šè­¦é€šçŸ¥
  await sendAlert({
    level: 'warning',
    message: `High error rate: ${(errorRate * 100).toFixed(1)}%`,
    details: executionStats
  });
}
```

### 3. æ€§èƒ½ç›‘æ§
```javascript
// ç›‘æ§èŠ‚ç‚¹æ‰§è¡Œæ—¶é—´
const nodePerformance = new Map();

function recordNodePerformance(nodeName, duration) {
  if (!nodePerformance.has(nodeName)) {
    nodePerformance.set(nodeName, []);
  }
  
  const times = nodePerformance.get(nodeName);
  times.push(duration);
  
  // ä¿æŒæœ€è¿‘ 100 æ¬¡è®°å½•
  if (times.length > 100) {
    times.shift();
  }
  
  // è®¡ç®—å¹³å‡æ—¶é—´
  const avgTime = times.reduce((a, b) => a + b, 0) / times.length;
  
  // æ£€æŸ¥æ€§èƒ½é—®é¢˜
  if (avgTime > 5000) { // å¹³å‡æ‰§è¡Œæ—¶é—´è¶…è¿‡ 5 ç§’
    console.warn(`Slow node detected: ${nodeName}, avg: ${avgTime.toFixed(0)}ms`);
  }
}
```

## ğŸ”§ æ—¥å¿—é…ç½®ä¼˜åŒ–

### 1. ç¯å¢ƒå˜é‡é…ç½®
```bash
# è®¾ç½®æ—¥å¿—çº§åˆ«
N8N_LOG_LEVEL=debug

# è®¾ç½®æ—¥å¿—è¾“å‡º
N8N_LOG_OUTPUT=console

# è®¾ç½®æ—¥å¿—æ–‡ä»¶
N8N_LOG_FILE=/var/log/n8n.log

# è®¾ç½®æ—¥å¿—è½®è½¬
N8N_LOG_MAX_SIZE=100m
N8N_LOG_MAX_FILES=5
```

### 2. è‡ªå®šä¹‰æ—¥å¿—æ ¼å¼
```javascript
// åœ¨ Code èŠ‚ç‚¹ä¸­è‡ªå®šä¹‰æ—¥å¿—æ ¼å¼
const logPrefix = `[${new Date().toISOString()}] [${$workflow.name}]`;

function customLog(level, message, data) {
  const logMessage = `${logPrefix} [${level.toUpperCase()}] ${message}`;
  
  if (data) {
    console.log(logMessage, data);
  } else {
    console.log(logMessage);
  }
}

// ä½¿ç”¨ç¤ºä¾‹
customLog('info', 'Processing started');
customLog('debug', 'Input data', $input.first().json);
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æ—¥å¿—è®°å½•åŸåˆ™
- **å®Œæ•´æ€§**ï¼šè®°å½•è¶³å¤Ÿçš„ä¿¡æ¯ç”¨äºè°ƒè¯•
- **å¯è¯»æ€§**ï¼šä½¿ç”¨æ¸…æ™°çš„æ—¥å¿—æ ¼å¼å’Œè¯­è¨€
- **æ€§èƒ½**ï¼šé¿å…è¿‡åº¦è®°å½•å½±å“æ€§èƒ½
- **å®‰å…¨æ€§**ï¼šä¸è¦è®°å½•æ•æ„Ÿä¿¡æ¯

### 2. è°ƒè¯•æµç¨‹
1. **é‡ç°é—®é¢˜**ï¼šç¡®ä¿èƒ½å¤Ÿé‡ç°é”™è¯¯
2. **æŸ¥çœ‹æ—¥å¿—**ï¼šä»å·¥ä½œæµæ‰§è¡Œæ—¥å¿—å¼€å§‹
3. **å®šä½èŠ‚ç‚¹**ï¼šç¡®å®šé—®é¢˜å‘ç”Ÿçš„å…·ä½“èŠ‚ç‚¹
4. **åˆ†ææ•°æ®**ï¼šæ£€æŸ¥èŠ‚ç‚¹çš„è¾“å…¥è¾“å‡ºæ•°æ®
5. **éªŒè¯ä¿®å¤**ï¼šç¡®è®¤ä¿®å¤åé—®é¢˜è§£å†³

### 3. é¢„é˜²æªæ–½
- **å®šæœŸæ£€æŸ¥**ï¼šå®šæœŸæŸ¥çœ‹æ‰§è¡Œæ—¥å¿—å’Œç»Ÿè®¡
- **è®¾ç½®å‘Šè­¦**ï¼šé…ç½®å…³é”®æŒ‡æ ‡çš„å‘Šè­¦é˜ˆå€¼
- **æ€§èƒ½ä¼˜åŒ–**ï¼šæŒç»­ç›‘æ§å’Œä¼˜åŒ–æ€§èƒ½ç“¶é¢ˆ
- **æ–‡æ¡£è®°å½•**ï¼šè®°å½•å¸¸è§é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ

## ğŸ‰ æ€»ç»“

æ‰§è¡Œæ—¥å¿—åˆ†ææ˜¯ n8n å·¥ä½œæµè°ƒè¯•å’Œä¼˜åŒ–çš„æ ¸å¿ƒæŠ€èƒ½ã€‚é€šè¿‡æŒæ¡æ—¥å¿—åˆ†ææ–¹æ³•ï¼Œæ‚¨å¯ä»¥ï¼š

1. **å¿«é€Ÿå®šä½é—®é¢˜**ï¼šå‡†ç¡®æ‰¾åˆ°é—®é¢˜å‘ç”Ÿçš„èŠ‚ç‚¹å’ŒåŸå› 
2. **ä¼˜åŒ–æ€§èƒ½**ï¼šè¯†åˆ«æ€§èƒ½ç“¶é¢ˆå¹¶ä¼˜åŒ–
3. **é¢„é˜²æ•…éšœ**ï¼šé€šè¿‡ç›‘æ§æå‰å‘ç°æ½œåœ¨é—®é¢˜
4. **æå‡æ•ˆç‡**ï¼šå‡å°‘è°ƒè¯•æ—¶é—´ï¼Œæé«˜å¼€å‘æ•ˆç‡

**ä¸‹ä¸€æ­¥**ï¼šç»“åˆæœ¬æŒ‡å—ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ç»ƒä¹ æ—¥å¿—åˆ†æï¼Œé€æ­¥æå‡è°ƒè¯•æŠ€èƒ½ã€‚
